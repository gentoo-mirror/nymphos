From 77af75f5d30bf3b4e3b45d0075ac7d302516daa7 Mon Sep 17 00:00:00 2001
From: neeshy <neeshy@tfwno.gf>
Date: Wed, 24 May 2023 20:41:43 -0400
Subject: [PATCH 4/4] su: don't set $PATH

Just /bin is too restrictive, and login shells set PATH anyway. Also,
carrying the PATH over for non-login shells is useful.
---
 su.c | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/su.c b/su.c
index 4fc3c04..4fc72e8 100644
--- a/su.c
+++ b/su.c
@@ -9,7 +9,6 @@
 #include <string.h>
 #include <unistd.h>
 
-#include "config.h"
 #include "passwd.h"
 #include "util.h"
 
@@ -104,10 +103,6 @@ main(int argc, char *argv[])
 		newargv[0] = shell;
 		newargv[1] = NULL;
 	}
-	if (strcmp(pw->pw_name, "root") == 0)
-		setenv("PATH", ENV_SUPATH, 1);
-	else
-		setenv("PATH", ENV_PATH, 1);
 	execve(shell, newargv, environ);
 	weprintf("execve %s:", shell);
 	return (errno == ENOENT) ? 127 : 126;
-- 
2.43.0

